<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>肿瘤知识推荐</title>
    <meta name="viewport"
          content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/settings.js"></script>
    <script type="text/javascript" src="/static/js/swiper-3.4.0.jquery.min.js"></script>
    <script src="/static/js/method.js"></script>
    <link rel="stylesheet" href="/static/css/swiper-3.2.7.min.css"/>
    <link rel="stylesheet" href="/static/css/index.css">
    <link rel="stylesheet" href="/static/css/layer-animate.css">
</head>
<body>
<div class="container">
    <div class="swiper-container swiper1">
        <div class="swiper-wrapper">
            <div class="swiper-slide selected">最新文章</div>
<<<<<<< HEAD
            <div class="swiper-slide">个性化推荐</div>
            <div class="swiper-slide">菜单 3</div>
            <div class="swiper-slide">菜单 4</div>
            <div class="swiper-slide">菜单 5</div>
            <div class="swiper-slide">菜单 6</div>
            <div class="swiper-slide">菜单 7</div>
            <div class="swiper-slide">菜单 8</div>
            <div class="swiper-slide">菜单 9</div>
=======
            <div class="swiper-slide">为您推荐</div>
            <div class="swiper-slide">更多发现</div>
            <div class="swiper-slide">资讯导航</div>
            <div class="swiper-slide">关于我们</div>
>>>>>>> 253aeed1539c3b5213963aaa952f77a9c920f40d
            <!--<div class="swiper-slide">菜单 10</div>-->
        </div>
    </div>
    <!-- swiper2 -->
    <div class="swiper-container swiper2">
        <div class="swiper-wrapper">
            <div class="swiper-slide swiper-no-swiping">
                <div style="width: 100%;height: 100%;background-color: gainsboro;">
                    <div class="content">
                        {% for article in data["latest"] %}
                            <div class="item">
<<<<<<< HEAD
                                <div class="article"><span><a href={{ article.url }}>{{ article.title }}</a></span>
=======
                                <div class="article"><span><a href={{ article.url }} class = "myurl">{{ article.title }}</a></span>
>>>>>>> 253aeed1539c3b5213963aaa952f77a9c920f40d
                                </div>
                                <div>
                                    <span class="from">{{ article.from }}</span>
                                    <div class="UpLayer">
                                        <div class="article_id" style="display: none;">{{ article.article_id }}</div>
<<<<<<< HEAD
                                        <span><a href="javascript:void(0)" class="limitRecommend">减少推荐</a></span>
=======
                                        <span><a href="javascript:void(0)" class="limitRecommend">不感兴趣</a></span>
>>>>>>> 253aeed1539c3b5213963aaa952f77a9c920f40d
                                        <ul>
                                            <li><a href="">原因：1</a></li>
                                            <li><a href="">原因：2</a></li>
                                            <li><a href="">原因：3</a></li>
                                            <li><a href="">原因：4</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="swiper-slide swiper-no-swiping">
                <div style="width: 100%;height: 100%;background-color: gainsboro;">
                    <div class="content">
                        {% for article in data["recommend"] %}
                            <div class="item">
<<<<<<< HEAD
                                <div class="article"><span><a href={{ article.url }}>{{ article.title }}</a></span>
=======
                                <div class="article"><span><a href={{ article.url }} class = "myurl">{{ article.title }}</a></span>
>>>>>>> 253aeed1539c3b5213963aaa952f77a9c920f40d
                                </div>
                                <div>
                                    <span class="from">{{ article.from }}</span>
                                    <div class="UpLayer">
                                        <div class="article_id" style="display: none;">{{ article.article_id }}</div>
                                        <span><a href="javascript:void(0)">减少推荐</a></span>
                                        <ul>
                                            <li><a href="">原因：1</a></li>
                                            <li><a href="">原因：2</a></li>
                                            <li><a href="">原因：3</a></li>
                                            <li><a href="">原因：4</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>

            </div>
            <div class="swiper-slide swiper-no-swiping">良医汇肿瘤咨询</div>
            <div class="swiper-slide swiper-no-swiping">内容 ressssssss</div>
            <div class="swiper-slide swiper-no-swiping">内容 ffffffffffff</div>

{#            <div class="swiper-slide swiper-no-swiping">内容 bbbbbbbbbbbbbbbbbvb</div>#}
{#            <div class="swiper-slide swiper-no-swiping">内容 bvcccccccccccbvb</div>#}
{#            <div class="swiper-slide swiper-no-swiping">内容 sdasdssssss</div>#}
{#            <div class="swiper-slide swiper-no-swiping">内容 oiouiouioiuoiuo</div>#}
            <!--<div class="swiper-slide swiper-no-swiping">内容 m,jnkjhkhgjghjugh</div>-->
        </div>
    </div>
</div>
<script>
    $(function () {
        function setCurrentSlide(ele, index) {
            $(".swiper1 .swiper-slide").removeClass("selected");
            ele.addClass("selected");
        }

        var swiper1 = new Swiper('.swiper1', {
            slidesPerView: 5.5,
            paginationClickable: true,//此参数设置为true时，点击分页器的指示点分页器会控制Swiper切换。
            spaceBetween: 10,//slide之间的距离（单位px）。
            freeMode: true,//默认为false，普通模式：slide滑动时只滑动一格，并自动贴合wrapper，设置为true则变为free模式，slide会根据惯性滑动且不会贴合。
            loop: false,//是否可循环
            onTab: function (swiper) {
                var n = swiper1.clickedIndex;
            }
        });
        swiper1.slides.each(function (index, val) {
            var ele = $(this);
            ele.on("click", function () {
                setCurrentSlide(ele, index);
                swiper2.slideTo(index, 500, false);
            });
        });

        var swiper2 = new Swiper('.swiper2', {
            direction: 'horizontal',//Slides的滑动方向，可设置水平(horizontal)或垂直(vertical)。
            loop: false,
            autoHeight: true,//自动高度。设置为true时，wrapper和container会随着当前slide的高度而发生变化。
            onSlideChangeEnd: function (swiper) {  //回调函数，swiper从一个slide过渡到另一个slide结束时执行。
                var n = swiper.activeIndex;
                setCurrentSlide($(".swiper1 .swiper-slide").eq(n), n);
                swiper1.slideTo(n, 500, false);
            }
        });
    });
    $(".limitRecommend").on("click", function () {
            if (confirm("是否减少此类文章的推荐?")) {
                $.ajax({
                    url: callbackUrl,
                    type: 'POST',
                    dataType: "JSON",
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({
                        "user_id": localStorage.getItem("user_id"),
                        "article_id": this.parentElement.parentElement.getElementsByClassName("article_id")[0].innerHTML,
                        "code": 2
                    }),
                    success: function (data) {
                        console.log(data);
                        if (data.flag == 1) {
                            console.log("该记录提交成功");
                        } else {
                            //为了保证记录提交成功，最好是失败之后缓存，稍后和其他操作一起提交
                        }
<<<<<<< HEAD
                    },
                    error: function (data) {
                        alert(data);
=======
                        alert("已经为您减少此类推荐");
                    },
                    error: function (data) {
                        alert("已经为您减少此类推荐");
>>>>>>> 253aeed1539c3b5213963aaa952f77a9c920f40d
                    }
                })
            } else {
                console.log("用户取消该操作");
            }
        }
    );
    /*
    <script>
    window.onbeforeunload=function(){
　　var e = window.event||e;
　　localStorage.setItem("lastOpen",Date.parse(new Date()));
}
    //window.onload = function () {
    //    var now = Date.parse(new Date());
    //    var lastOpen = localStorage.getItem("lastOpen")!=null?localStorage.getItem("lastOpen"):0;
    //    alert("浏览时长:"+(now-lastOpen)/1000+"秒");
    //}
    window.addEventListener("popstate", function(e) {
        alert("我监听到了浏览器的返回按钮事件啦");//根据自己的需求实现自己的功能
        var now = Date.parse(new Date());
        var lastOpen = localStorage.getItem("lastOpen")!=null?localStorage.getItem("lastOpen"):0;
        alert("浏览时长:"+(now-lastOpen)/1000+"秒");
    }, false);

     */
</script>
</body>

</html>